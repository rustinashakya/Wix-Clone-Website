//esm-shim-webpack-plugin-imports
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"));else if("function"==typeof define&&define.amd)define(["lodash"],t);else{var n="object"==typeof exports?t(require("lodash")):t(e._);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(self,(e=>(()=>{"use strict";var t={9847:t=>{t.exports=e}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.r(i),o.d(i,{accessibility:()=>he,account:()=>we,application:()=>f,components:()=>y,controllers:()=>b,environment:()=>Ae,errors:()=>Ce,fonts:()=>S,history:()=>O,info:()=>W,language:()=>F,menu:()=>x,mobile:()=>Re,pages:()=>L,pagesGroup:()=>k,permissions:()=>be,responsiveLayout:()=>Pe,routers:()=>q,siteMembers:()=>Y,siteSegments:()=>j,theme:()=>z,tpa:()=>De,transactions:()=>Ee,vfs:()=>ve,waitForChangesApplied:()=>c,wixapps:()=>Te});var e=o(9847),t=o.n(e);const n="registerError_",r=Object.freeze({EXTENSION:"extension",DEFAULT:"default"}),p=e=>e.context===r.EXTENSION;function a(e,t,n){let{isRequired:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{isRequired:!1};const i=p(e)?null==t?void 0:t[n]:null==e?void 0:e[n];if(o&&void 0===i)throw new Error("option ".concat(n," is required"));return i}const s=(e,t)=>new Promise((n=>{e.waitForChangesApplied((()=>n(t)))})),c=(e,t)=>e.waitForChangesApplied(t),d=(e,t,n)=>t.runInContext(e,n),u=(e,t)=>!!p(e)||t===e.appDefinitionId,l={changeVariation:function(e,t,n,o){let{componentRef:i,variationId:r}=o;return new Promise((n=>{d(t.appDefinitionId,e,(()=>e.appStudioWidgets.changeVariation(i,r,n)))}))},changePreset:function(e,t,n,o){let{componentRef:i,stylePresetId:r,layoutPresetId:p}=o;return d(t.appDefinitionId,e,(()=>e.appStudioWidgets.presets.change(i,r,p)))},addWidget:function(e,t,n,o){const{appDefinitionId:i,widgetId:r,scopedPresets:p,presetIds:s,layouts:c,...u}=o,l=o.containerRef,f="RefComponentProperties";function g(e,t){if(!e.desktop&&!e.mobile)return{};const{mobile:n,desktop:o}=e;return{...o?{layout:{...t,width:o.width.value,height:o.height.value}}:{layout:t},...o?{props:{minHeight:o.height.value,type:f}}:{},...n?{mobileHints:{type:"MobileHints",recommendedHeight:n.height.value,recommendedWidth:n.width.value,props:{minHeight:n.height.value,type:f}}}:{}}}return new Promise(((n,c)=>{const f=a(t,{appDefinitionId:i},"appDefinitionId",{isRequired:!0});d(t.appDefinitionId,e,(()=>{var t;return e.appStudioWidgets.addWidget(f,r,{...u,containerRef:l,presets:null!==(t=null==p?void 0:p.desktop)&&void 0!==t?t:s,...o.dimensionsByDevice?g(o.dimensionsByDevice,o.layout):{},onSuccess:async e=>{n(e)},onError:c})}))}))},getPreset:function(e,t,n,o){let{componentRef:i}=o;return d(t.appDefinitionId,e,(()=>e.appStudioWidgets.presets.get(i)))},props:{get:function(e,t,n,o){let{widgetRef:i}=o;return d(t.appDefinitionId,e,(()=>e.appStudioWidgets.props.get(i)))},set:function(e,t,n,o){let{widgetRef:i,newProps:r,shouldFetchData:p}=o;return d(t.appDefinitionId,e,(()=>e.appStudioWidgets.props.set(i,r,{shouldFetchData:p})))}},designVariables:{get:function(e,t,n,o){let{widgetRef:i}=o;return d(t.appDefinitionId,e,(()=>e.appStudioWidgets.designVariables.get(i,i)))},set:function(e,t,n,o){let{widgetRef:i,newValues:r}=o;return d(t.appDefinitionId,e,(()=>e.appStudioWidgets.designVariables.set(i,i,r)))}}},f={install:function(e,n,o,i){return new Promise(((o,r)=>{const{appDefinitionId:p,originInfo:a,editorType:s,sourceTemplateId:c,isSilent:u}=i;if(!p)return void r(new Error("options must contain appDefinitionId"));const l={appDefinitionId:t().get(n,"appDefinitionId")},f={origin:{initiator:"APP",type:s,info:a?t().assign({},a,l):l}};c&&(f.sourceTemplateId=c),u&&(f.isSilent=!0),d(n.appDefinitionId,e,(()=>e.platform.provision(p,f).then(o,r)))}))},uninstall:function(e,t,n){let{appDefinitionId:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((n=>{const i=a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:!0});d(t.appDefinitionId,e,(()=>e.platform.uninstall(i))),e.waitForChangesApplied(n)}))},isApplicationInstalled:function(e,t,n,o){let{appDefinitionId:i}=o;return new Promise(((n,o)=>{i?d(t.appDefinitionId,e,(()=>n(e.platform.isAppActive(i)))):o(new Error("options must contain appDefinitionId"))}))},registerToCustomEvents:function(e,t,n,o){let{eventTypes:i,appDefinitionId:r}=o;const p=a(t,{appDefinitionId:r},"appDefinitionId",{isRequired:!0});return d(t.appDefinitionId,e,(()=>e.platform.registerAppToCustomEventsByAppDefId(p,i)))},getAppDataByAppDefId:function(e,t,n,o){return d(t.appDefinitionId,e,(()=>e.platform.getAppDataByAppDefId(o)))},appStudioWidgets:l,sessionState:{update:function(e,t,n,o){let{stateMap:i}=o;return d(t.appDefinitionId,e,(()=>e.platform.sessionState.update(i))),s(e)}},livePreview:{refresh:function(e,t,n){let{source:o,shouldFetchData:i,appDefinitionId:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const p=a(t,{appDefinitionId:r},"appDefinitionId",{isRequired:!0});return e.platform.livePreview.refresh({apps:[p],source:o||"EditorSDK",shouldFetchData:i})}}},g=(e,t)=>"wysiwyg.viewer.components.RefComponent"===e.components.getType(t),m={removeAllOverrides:function(e,t,n,o){let{componentRef:i}=o;return new Promise(((n,o)=>{if(g(e,i))if(u(t,e.components.data.get(i).appDefinitionId))try{d(t.appDefinitionId,e,(()=>{e.components.refComponents.removeAllOverrides(i),c(e,(()=>n()))}))}catch(e){o(e)}else o("The component with id '".concat(i.id,"' doesn't belong to this app."));else o("This method remove overrides only for a refComponent.")}))},removeOverrides:function(e,t,n,o){let{componentRef:i,...r}=o;return new Promise(((n,o)=>{if(g(e,i))if(u(t,e.components.data.get(i).appDefinitionId))try{d(t.appDefinitionId,e,(()=>{e.components.refComponents.removeOverrides(i,r),c(e,(()=>n()))}))}catch(e){o(e)}else o("The component with id '".concat(i.id,"' doesn't belong to this app."));else o("This method remove overrides only for a refComponent.")}))},getAllAppRefComponents:function(e,t,n){let{appDefinitionId:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=e.deprecatedOldBadPerformanceApis.components.getAllComponentsFromFull(),r=a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:!0});return i.filter((t=>{const n=e.components.data.get(t)||{};return"WidgetRef"===n.type&&n.appDefinitionId===r}))},isRefComponentCollapsed:function(e,n,o,i){let{componentRef:r}=i;return"COLLAPSED"===t().get(e.components.properties.get(r),"ghost")},getCollapsedRefComponents:function(e,t,n,o){let{componentRef:i,includeInnerCollapsed:r}=o;if(!g(e,i))throw new Error("This method get collapsed components only for a refComponent.");if(!u(t,e.components.data.get(i).appDefinitionId))throw new Error("The component with id '".concat(i.id,"' doesn't belong to this app."));const p=[i];if(r){const t=e.deprecatedOldBadPerformanceApis.components.getChildren(i,!0);p.push(...t.filter((t=>g(e,t))))}return p.reduce(((t,n)=>{const o=e.components.refComponents.getAllGhostRefComponentsPrimaryConnection(n);return o&&Object.keys(o).forEach((i=>{var r;t.push({refHost:n,componentRef:e.components.get.byId(i),role:null===(r=o[i])||void 0===r?void 0:r.role})})),t}),[])},collapseReferredComponent:function(e,t,n,o){let{componentRef:i}=o;return new Promise(((n,o)=>{if(!e.components.refComponents.isReferredComponent(i))return o("The component with id '".concat(i.id,"' isn't a referred component."));const r=e.components.refComponents.getRefHostCompPointer(i);if(!u(t,e.components.data.get(r).appDefinitionId))return o("The component with id '".concat(i.id,"' doesn't belong to this app."));try{d(t.appDefinitionId,e,(()=>e.components.remove(i))),e.waitForChangesApplied(n)}catch(e){return o(e)}}))},getTemplateComponent:(e,t,n,o)=>{let{componentRef:i}=o;return e.components.refComponents.getTemplateCompPointer(i)},getHostComponentRef:(e,t,n,o)=>{let{componentRef:i}=o;return e.components.refComponents.getRefHostCompPointer(i)},expandReferredComponent:function(e,t,n,o){let{componentRef:i}=o;return new Promise(((n,o)=>{if(!e.components.refComponents.isReferredComponent(i))return o("The component with id '".concat(i.id,"' isn't a referred component."));const r=e.components.refComponents.getRefHostCompPointer(i);if(!u(t,e.components.data.get(r).appDefinitionId))return o("The component with id '".concat(i.id,"' doesn't belong to this app."));try{d(t.appDefinitionId,e,(()=>e.components.refComponents.unGhostifyComponent(i))),e.waitForChangesApplied(n)}catch(e){return o(e)}}))},hasOverrides:function(e,t,n,o){let{componentRef:i}=o;return new Promise(((n,o)=>{if(g(e,i))if(u(t,e.components.data.get(i).appDefinitionId)){try{d(t.appDefinitionId,e,(()=>e.components.refComponents.hasOverridesToBeRemoved(i)))}catch(e){o(e)}n()}else o("The component with id '".concat(i.id,"' doesn't belong to this app."));else o("This method checks overrides only for a refComponent.")}))}},I="layoutResponsive",D=new Set,y={add:function(e,n,o){let{componentDefinition:i,pageRef:r,customId:p,optionalIndex:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise(((o,s)=>{t().has(i,"componentType")||s(new Error("componentDefinition must contain componentType"));const u=e.components.buildDefaultComponentStructure(i.componentType);t().merge(u,i);const l=d(n.appDefinitionId,e,(()=>e.components.add(r,u,p,a)));c(e,(()=>o(l)))}))},addAndAdjustLayout:function(e,n,o){let{componentDefinition:i,pageRef:r,customId:p,optionalIndex:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise(((o,s)=>{t().has(i,"componentType")||s(new Error("componentDefinition must contain componentType"));const u=e.components.buildDefaultComponentStructure(i.componentType);t().merge(u,i);const l=d(n.appDefinitionId,e,(()=>e.components.addAndAdjustLayout(r,u,p,a)));c(e,(()=>o(l)))}))},remove:function(e,t,n,o){let{componentRef:i}=o;e.viewMode.get()===e.viewMode.VIEW_MODES.MOBILE?d(t.appDefinitionId,e,(()=>e.mobile.hiddenComponents.hide(i))):d(t.appDefinitionId,e,(()=>e.components.remove(i)))},get:function(e,n,o,i){let{componentRefs:r,properties:p=[],appDefinitionId:s}=i;const c=t().compact(t().isArray(r)?r:[r]);return t().transform(c,((o,i)=>{const r={componentRef:i},c=new Map([["componentType",()=>e.components.getType(i)],["props",()=>e.components.properties.get(i)],["data",()=>e.components.data.get(i)],["layout",()=>e.components.layout.get(i)],["sdkType",()=>e.wixCode.getCompSdkType(i)],["connections",()=>e.platform.controllers.connections.get(i)],["style",()=>e.components.style.get(i)],["role",()=>{const o=e.platform.controllers.connections.get(i),r=a(n,{appDefinitionId:s},"appDefinitionId",{isRequired:!0}),p=t().find(o,(t=>{const n=e.components.data.get(t.controllerRef);return((null==n?void 0:n.appDefinitionId)||(null==n?void 0:n.applicationId))===r}));return t().get(p,"role")}]]),d=[];if(p.forEach((e=>{c.has(e)?r[e]=c.get(e)():d.push(e)})),d.length){const n=1===d.length&&d[0]===I;if(D.has(i.id)&&n)n&&(r[I]=void 0);else{const n=!d.includes("components"),o=e.components.serialize(i,null,n);(null==(u=o)?void 0:u[I])||D.add(i.id),t().assign(r,t().pick(o,d))}}var u;o.push(r)}),[])},serialize:function(e,t,n,o){let{componentRef:i,maintainIdentifiers:r=!1}=o;return e.components.serialize(i,null,!1,r)},isRepeatedComponent:function(e,t,n,o){let{componentRef:i}=o;return e.components.is.repeatedComponent(i)},migrate:function(e,t,n,o){let{componentRef:i,componentDefinition:r}=o;return e.components.migrate(i,r)},getAllComponents:function(e){return e.deprecatedOldBadPerformanceApis.components.getAllComponents()},getPage:function(e,t,n,o){let{componentRef:i}=o;return e.components.getPage(i)},getById:function(e,t,n,o){let{id:i}=o;return e.components.get.byId(i)},getChildren:function(e,t,n,o){let{componentRef:i,recursive:r=!1,fromDocument:p=!1}=o;return(p?e.deprecatedOldBadPerformanceApis.components.getChildrenFromFull:e.deprecatedOldBadPerformanceApis.components.getChildren)(i,r)},getAncestors:function(e,t,n,o){let{componentRef:i}=o;return e.deprecatedOldBadPerformanceApis.components.getAncestors(i)},getType:function(e,t,n,o){let{componentRef:i}=o;return e.components.getType(i)},isFullWidth:function(e,t,n,o){let{componentRef:i}=o;if(!i)throw new Error("options must include componentRef property");return e.components.is.fullWidth(i)},setFullWidth:function(e,t,n,o){let{componentRef:i,fullWidth:r,margins:p}=o;if(!i)throw new Error("options must include componentRef property");if("boolean"!=typeof r)throw new Error("options must include fullWidth boolean property");return new Promise((t=>{if(r){const{left:t,right:n}=p||{},o={left:Object.assign({vw:0},t),right:Object.assign({vw:0},n)};e.components.layout.setDock(i,o)}else e.components.layout.unDock(i);c(e,t)}))},buildDefaultComponentStructure:function(e,t,n,o){let{componentType:i}=o;return e.components.buildDefaultComponentStructure(i)},findAllByType:function(e,t,n,o){let{componentType:i}=o;return e.components.get.byType(i)},code:{getNickname:function(e,t,n,o){let{componentRef:i}=o;if(!i)throw new Error("options must include componentRef property");return e.components.code.getNickname(i)},setNickname:function(e,t,n,o){let{componentRef:i,nickname:r}=o;if(!i)throw new Error("options must include componentRef property");if(!r)throw new Error("options must include nickname property");const p=e.components.code.validateNickname(i,r);if("VALID"!==p)throw new Error(p);return e.components.code.setNickname(i,r)}},behaviors:{getRuntimeState:function(e,t,n,o){let{componentRef:i}=o;return e.components.behaviors.getRuntimeState(i)},execute:function(e,t,n,o){let{componentRef:i,behaviorName:r,behaviorParams:p}=o;return d(t.appDefinitionId,e,(()=>e.components.behaviors.execute(i,r,p))),s(e)},get:function(e,t,n,o){let{componentRef:i}=o;return e.components.behaviors.get(i)},update:function(e,t,n,o){let{componentRef:i,behavior:r}=o;return e.components.behaviors.update(i,r)},remove:function(e,t,n,o){let{componentRef:i,behaviorName:r,actionName:p}=o;return e.components.behaviors.remove(i,r,p)}},properties:{get:function(e,t,n,o){let{componentRef:i}=o;return e.components.properties.get(i)},update:function(e,t,n,o){let{componentRef:i,props:r}=o;d(t.appDefinitionId,e,(()=>e.components.properties.update(i,r)))}},data:{get:function(e,t,n,o){let{componentRef:i}=o;return e.components.data.get(i)},update:function(e,t,n,o){let{componentRef:i,data:r}=o;d(t.appDefinitionId,e,(()=>e.components.data.update(i,r)))},updateInLanguage:function(e,t,n,o){let{componentRef:i,data:r,languageCode:p}=o;d(t.appDefinitionId,e,(()=>e.components.data.updateInLang(i,r,p)))}},layout:{get:function(e,t,n,o){let{componentRef:i}=o;return e.components.layout.get(i)},update:function(e,t,n,o){let{componentRef:i,layout:r}=o;d(t.appDefinitionId,e,(()=>e.components.layout.update(i,r)))}},style:{get:function(e,t,n,o){let{componentRef:i}=o;return e.components.style.get(i)},update:function(e,t,n,o){let{componentRef:i,style:r}=o;d(t.appDefinitionId,e,(()=>e.components.style.setCustom(i,null,r)))},updateFull:function(e,t,n,o){let{componentRef:i,style:r}=o;d(t.appDefinitionId,e,(()=>e.components.style.update(i,r)))}},stylable:{mergeStylesheets:function(e,t,n){return e.components.stylable.mergeStylesheets(t,n)},update:function(e,t,n,o){let{componentRef:i,style:r}=o;d(t.appDefinitionId,e,(()=>e.components.stylable.update(i,r)))}},design:{get:function(e,t,n,o){let{componentRef:i}=o;return e.components.design.get(i)},update:function(e,t,n,o){let{componentRef:i,designItem:r,design:p,retainCharas:a}=o;d(t.appDefinitionId,e,(()=>e.components.design.update(i,p||r,a)))}},modes:{showComponentOnlyOnPagesGroup:function(e,t,n,o){let{componentPointer:i,componentRef:r=i,pagesGroupPointer:p}=o;d(t.appDefinitionId,e,(()=>e.components.modes.showComponentOnlyOnPagesGroup(r,p)))},activateComponentMode:function(e,t,n,o){let{componentRef:i,modeId:r}=o;d(t.appDefinitionId,e,(()=>e.components.modes.activateComponentMode(i,r)))},applyCurrentToAllModes:function(e,t,n,o){let{componentRef:i}=o;d(t.appDefinitionId,e,(()=>e.components.modes.applyCurrentToAllModes(i)))},getModes:function(e,t,n,o){let{componentRef:i}=o;return e.components.modes.getModes(i)}},arrangement:{moveToIndex:function(e,t,n,o){let{componentRef:i,index:r}=o;return d(t.appDefinitionId,e,(()=>e.components.arrangement.moveToIndex(i,r)))},getIndex:function(e,t,n,o){let{componentRef:i}=o;if(!i)throw new Error("options must include componentRef property");return e.components.arrangement.getCompIndex(i)}},refComponents:m},v="platform.components.AppController",R="platform.components.AppWidget",P={SITE_HEADER:!0,SITE_FOOTER:!0},h=(e,n)=>t()(n).thru(e.components.getAncestors).reverse().tail().map("id").head();function w(e,t,n,o,i){let{appDefinitionId:r}=t;const p=n?n.id:null,a=t=>!p||!e.pages.popupPages.isPopup(p)||"masterPage"!==e.components.getPage(t).id;return(i?e.deprecatedOldBadPerformanceApis.components.getAllComponentsFromFull:e.deprecatedOldBadPerformanceApis.components.getAllComponents)(p,(t=>{var n,i;const p=e.components.getType(t);return function(e){return e===v||e===R}(p)&&(null===(n=e.components.data.get(t))||void 0===n?void 0:n.applicationId)===r&&a(t)||o&&e.tpa.isTpaByCompType(p)&&(null===(i=e.components.data.get(t))||void 0===i?void 0:i.appDefinitionId)===r&&a(t)}))}function C(e,n,o,i){const r=w(e,n,o,i),p=t()(r).map(e.components.refComponents.getTemplateCompPointer).compact().keyBy("id").value();return t()(r).reject((e=>{let{id:t}=e;return p[t]})).map((e=>({controllerRef:e}))).value()}const T=function(e,t,n){let{pageRef:o=e.pages.getFocusedPage(),appDefinitionId:i,includeTPAWidget:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return C(e,{appDefinitionId:a(t,{appDefinitionId:i},"appDefinitionId",{isRequired:!0})},o,r)};function A(e,n,o,i){let{controllerRef:r,scope:p="COMPONENT"}=i;const a=e.tpa.isTpaByCompType(e.components.getType(r)),s=e.components.data.get(r);if(a)return function(e,t){let{controllerRef:n,compData:o,scope:i}=t,r={};e.tpaV2.data.getPublicData(o.applicationId,n,(e=>{if(e.error)throw new Error(e.error);r=e}));const p=e.platform.controllers.getName(n);return{type:o.widgetId,config:r[i],displayName:p}}(e,{controllerRef:r,compData:s,scope:p});const c=e.platform.controllers.settings.get(r);return{type:t().get(s,"controllerType"),config:c,displayName:e.platform.controllers.getName(r)}}function E(e,t,n,o){let{controllerRef:i}=o;return e.platform.controllers.connections.getControllerConnections(i)}const b={listControllers:T,listAllControllers:function(e,t,n){let{appDefinitionId:o,includeTPAWidget:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return C(e,{appDefinitionId:a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:!0})},null,i)},listConnectableControllers:function(e,n,o,i){let{componentRef:r,appDefinitionId:p,includeTPAWidget:s}=i;const c=e.components.getPage(r),d={appDefinitionId:a(n,{appDefinitionId:p},"appDefinitionId",{isRequired:!0})},u=w(e,d,c,s,!0),l=h(e,r);return t()(u).filter((n=>function(e,t,n,o){const i=e.components.getPage(o);if("masterPage"===i.id){const t=h(e,o);return!(t&&!P[t])||n===t}return t===i.id}(e,t().get(c,"id"),l,n))).filter((t=>function(e,t,n){return e.components.getType(n)!==R||e.components.isDescendantOfComp(t,n)}(e,r,t))).map((e=>({controllerRef:e}))).value()},getControllerConnections:E,listControllerConnections:E,listConnections:function(e,n,o,i){let{componentRef:r}=i;const p=e.platform.controllers.connections.get(r);return t().reject(p,{type:"WixCodeConnectionItem"})},listConnectedComponents:function(e,t,n,o){let{controllerRef:i}=o;return e.platform.controllers.connections.getConnectedComponents(i)},connect:function(e,t,n,o){let{connectToRef:i,controllerRef:r,role:p,connectionConfig:a,isPrimary:s,subRole:c}=o;return d(t.appDefinitionId,e,(()=>e.platform.controllers.connections.connect(i,r,p,a,s,c))),{connectToRef:i,controllerRef:r,role:p,subRole:c}},disconnect:function(e,t,n,o){let{connectToRef:i,controllerRef:r,role:p}=o;return d(t.appDefinitionId,e,(()=>e.platform.controllers.connections.disconnect(i,r,p)))},getData:A,saveConfiguration:function(e,t,n,o){let{controllerRef:i,config:r,scope:p="COMPONENT"}=o;const a=e.components.getType(i);return e.tpa.isTpaByCompType(a)?new Promise(((n,o)=>d(t.appDefinitionId,e,(()=>e.tpa.data.setMultiple(i,r,p,(e=>e.error?o(new Error(e.error.message)):n(e))))))):d(t.appDefinitionId,e,(()=>e.platform.controllers.settings.set(i,r)))},setDisplayName:function(e,t,n,o){let{controllerRef:i,name:r}=o;return d(t.appDefinitionId,e,(()=>e.platform.controllers.setName(i,r)))},setState:function(e,t,n,o){let{state:i}=o;return d(t.appDefinitionId,e,(()=>e.platform.controllers.setState(i)))},setExternalId:function(e,t,n,o){let{controllerRef:i,externalId:r}=o;return d(t.appDefinitionId,e,(()=>e.platform.controllers.settings.setExternalId(i,r))),s(e)},getExternalId:function(e,t,n,o){let{controllerRef:i}=o;return e.platform.controllers.settings.getExternalId(i)},findAllByType:function(e,t,n,o){let{controllerType:i,pageRef:r,appDefinitionId:p}=o;const a=T(e,t,n,{pageRef:r||null,appDefinitionId:p}),s=[];for(const t of a)A(e,0,0,t).type===i&&s.push(t);return s},moveAppControllerToMasterPage:function(e,t,n,o){let{controllerRef:i}=o;return e.platform.controllers.relocate.moveAppControllerToMasterPage(i)},moveAppControllerToPage:function(e,t,n,o){let{controllerRef:i,pageRef:r}=o;return e.platform.controllers.relocate.moveAppControllerToPage(i,r)}},S={getFontsOptions:function(e){return e.fonts.getFontsOptions()}},O={add:function(e,t,n,o){let{label:i,params:r}=o;return new Promise((t=>c(e,(()=>{e.history.add(i,{__appParams:r}),t()}))))}};function M(e,t,n){let{appDefinitionId:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:!0}),r="wix-code"===t.appDefinitionId?e.wixCode.getClientSpec().appDefinitionId:i;return e.tpa.app.getDataByAppDefId(r).instance}const W={getSiteId:function(e){return e.generalInfo.getSiteId()},getMetaSiteId:function(e){return e.generalInfo.getMetaSiteId()},getPublicUrl:function(e){return e.generalInfo.getPublicUrl()},isSitePublished:function(e){return e.generalInfo.isSitePublished()},getLanguage:function(e){return e.generalInfo.getLanguage()},getRegionalLanguage:function(e){return e.generalInfo.getRegionalLanguage()},isSiteSaved:function(e){return!e.generalInfo.isFirstSave()&&!e.generalInfo.isDraft()},isHttpsEnabled:function(e){return e.generalInfo.isHttpsEnabled()},getAppInstance:M,getAppInstancePayload:function(e,t,n){const o=M(e,t,n);return o?function(e){try{if(e.startsWith("OauthNG")){const t=e.split(".")[3],n=JSON.parse(atob(t)).data;return JSON.parse(n).instance}const t=e.split(".")[1];return JSON.parse(atob(t))}catch(t){throw new Error("Unable to parse app's instance token. Token - ".concat(e))}}(o):null},getAppInstanceId:function(e,t,n){let{appDefinitionId:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:!0}),r="wix-code"===t.appDefinitionId?e.wixCode.getClientSpec().appDefinitionId:i;return e.tpa.app.getDataByAppDefId(r).instanceId},getCurrency:function(e){return e.generalInfo.getCurrency()},getTimeZone:function(e){return e.generalInfo.getTimeZone()},getUserId:function(e){return e.generalInfo.getUserInfo().userId},getUserInfo:function(e){return e.generalInfo.getUserInfo()},getVendorProductId:function(e,t,n,o){const i=null==o?void 0:o.appDefinitionId;if(!i&&p(t))throw new Error("options must contain appDefinitionId");const r=e.platform.getAppDataByAppDefId(i||t.appDefinitionId);return null==r?void 0:r.vendorProductId},getRegion:function(e){return e.generalInfo.getLocale()},getArtifactsUrls:function(e,t,n){return e.generalInfo.getArtifactsUrl(n)},getArtifactOverrides:function(e){return e.generalInfo.getArtifactOverrides()},getSiteDisplayName:function(e){return e.siteDisplayName.get()},getStageViewMode:function(e){return e.documentMode.getComponentViewMode()},getSiteMap:function(e){return e.tpa.getSiteMap()},getUserGEO:function(e){return e.generalInfo.getGeo()},getAppRevisionOverrides:function(e){return e.generalInfo.getAppRevisionOverrides()}},F={add:function(e,t,n,o){let{languageCode:i}=o;return d(t.appDefinitionId,e,(()=>e.language.add(i))),s(e)},current:{set:function(e,t,n,o){let{languageCode:i}=o;return d(t.appDefinitionId,e,(()=>e.language.current.set(i)))},get:function(e,t){return d(t.appDefinitionId,e,(()=>e.language.current.get()))}},component:{getTranslations:function(e,t,n,o){let{componentRef:i}=o;return e.language.component.getTranslations(i)},data:{remove:function(e,t,n,o,i){return d(t.appDefinitionId,e,(()=>e.multilingual.components.data.remove(o,i)))}}},original:{get:function(e){return e.language.original.get()}},setLanguages:function(e,t){return e.language.init(t)},getTranslationLanguages:function(e){return e.language.getFull()},autoTranslate:()=>{throw new Error("not implemented for this editor")},multilingual:{isEnabled:function(e){return e.language.multilingual.isEnabled()},languages:{remove:function(e,t,n,o){return d(t.appDefinitionId,e,(()=>e.multilingual.languages.remove(o)))},removeAll:function(e,t){return d(t.appDefinitionId,e,(()=>e.multilingual.languages.removeAll()))}}}},N=["MEMBERS_SUB_MENU","MEMBERS_LOGIN_MENU","MEMBERS_LOGIN_ICONS_MENU","CUSTOM_MAIN_MENU","CUSTOM_MENU"],x={create:function(e,n,o,i){let{menuData:r,customId:p,appDefinitionId:s}=i;const c=a(n,{appDefinitionId:s},"appDefinitionId",{isRequired:!0}),u=t().assign({appDefinitionId:c},r);return d(n.appDefinitionId,e,(()=>e.menu.create(u,p)))},connect:function(e,t,n,o){let{menuCompPointer:i,menuId:r}=o;d(t.appDefinitionId,e,(()=>e.menu.connect(i,r)))},update:function(e,t,n,o){let{menuId:i,menuData:r}=o;d(t.appDefinitionId,e,(()=>e.menu.update(i,r)))},remove:function(e,t,n,o){let{menuId:i}=o;d(t.appDefinitionId,e,(()=>e.menu.remove(i)))},addItem:function(e,t,n,o){let{menuId:i,menuItem:r}=o;d(t.appDefinitionId,e,(()=>e.menu.addItem(i,r)))},getById:function(e,t,n,o){let{menuId:i}=o;return e.menu.getById(i)},getDefaultMenuId:function(e,t){return d(t.appDefinitionId,e,(async()=>{const t=(await e.menu.getAll()).filter((e=>!N.includes(e.id)));if(0===t.length)return null;const n=t.find((e=>"MAIN_MENU"===e.menuType)),o=t[0];return(n||o).id}))}};function B(e,n,o,i,r){let{pageRef:p,pageLink:a}=i;const c=t().get(p,"id")||a;if(c)return d(n.appDefinitionId,e,(()=>e.pages.navigateTo(c))),s(e,r)}const G="openPopup";function _(e,t,n,o){let{pageRef:i}=o;return e.pages.data.get(i.id)}const L={navigateTo:B,setState:function(e,t,n,o){let{state:i}=o;d(t.appDefinitionId,e,(()=>e.platform.pages.setState(i)))},getCurrent:function(e){return e.pages.getReference(e.pages.getFocusedPageId())},getPrimary:function(e){return e.pages.getReference(e.pages.getPrimaryPageId())},getHomePage:function(e){const t=e.homePage.get();return e.components.get.byId(t)},add:function(e,t,n,o){let{title:i,definition:r,shouldAddMenuItem:p,shouldNavigateToPage:a=!0}=o;const s=d(t.appDefinitionId,e,(()=>e.pages.add(i,r,p)));return a?B(e,t,0,{pageRef:s},s):s},getPageData:_,isDynamicPage:function(e,t,n,o){let{pageRef:i}=o;const r=e.routers.getRouterRef.byPage(i);return Boolean(r)},rename:function(e,t,n,o){let{pageRef:i,title:r}=o;return d(t.appDefinitionId,e,(()=>e.pages.data.update(i.id,{title:r})))},duplicate:function(e,t,n,o){let{pageId:i,shouldAddMenuItem:r,shouldDuplicatePageCode:p}=o;return d(t.appDefinitionId,e,(()=>e.pages.duplicate(i,r,p)))},data:{get:_,getAll:function(e){return e.pages.getPagesData()},update:function(e,t,n,o){let{pageRef:i,data:r,applyChangeToAllLanguages:p}=o;d(t.appDefinitionId,e,(()=>e.pages.data.update(i.id,r,void 0,p)))}},pageUriSEO:{convertPageNameToUrl:function(e,t,n,o){let{title:i}=o;return e.pages.data.pageUriSEO.convertPageNameToUrl(i)}},serialize:function(e,t,n,o){let{pageRef:i,maintainIdentifiers:r=!1}=o;return e.pages.serialize(i.id,r)},permissions:{hasPassword:function(e,t,n,o){let{pageRef:i}=o;return e.pages.permissions.hasPassword(i.id)},updatePagePassword:function(e,t,n,o){let{pageRef:i,plainPassword:r}=o;d(t.appDefinitionId,e,(()=>e.pages.permissions.updatePassword(i.id,r)))},removePagePassword:function(e,t,n,o){let{pageRef:i}=o;d(t.appDefinitionId,e,(()=>e.pages.permissions.removePassword(i.id)))},duplicatePagePassword:function(e,t,n,o){let{destinationPageRef:i,sourcePageRef:r}=o;return new Promise(((n,o)=>{d(t.appDefinitionId,e,(()=>e.pages.permissions.duplicatePagePassword(i.id,r.id,n,o)))}))},duplicateGroupsPermissions:function(){return new Promise((e=>{e()}))}},remove:function(e,t,n,o){let{pageRef:i}=o;return new Promise(((n,o)=>{const r=e.pages.data.get(i.id);if(!r)return void o("page with id '".concat(i.id,"' doesn't exist"));if(!u(t,r.managingAppDefId))return void o("page with id '".concat(i.id,"' can not be deleted. page is not managed by this application"));const{id:p}=e.pages.getCurrentPage();if(p===i.id)return void o("It is not allowed to delete current page (".concat(i.id,"), please navigate to another page"));const a=e.homePage.get();if(i.id!==a)if(r.tpaApplicationId&&e.tpa.app.shouldDeleteWholeApp(r))o("It is not allowed to delete a section page '(".concat(i.id,")'"));else{try{d(t.appDefinitionId,e,(()=>e.pages.remove(i.id)))}catch(e){return void o(e)}n()}else o("It is not allowed to delete homePage (".concat(i.id,"), please set a new page as homePage and try again"))}))},getApplicationPages:function(e,t,n){let{appDefinitionId:o,includeUnmanaged:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:i});return r?e.pages.getPagesData().filter((e=>{let{managingAppDefId:t,appDefinitionId:n}=e;return t===r||i&&n===r})):[]},popupPages:{add:(e,t,n,o)=>{let{title:i,definition:r,shouldNavigateToPage:p=!0}=o;const a=d(t.appDefinitionId,e,(()=>e.pages.popupPages.add(i,r)));return p?B(e,t,0,{pageRef:a},a):a},addConnected:(e,n,o,i)=>{let{title:r,definition:p,controllerType:s,popupRole:u,shouldNavigateToPage:l=!0,appDefinitionId:f}=i;return new Promise((o=>{d(n.appDefinitionId,e,(()=>{const i=e.pages.popupPages.add(r,p),d=a(n,{appDefinitionId:f},"appDefinitionId",{isRequired:!0}),g=t().defaultsDeep({data:{controllerType:s,name:s,applicationId:d}},e.components.buildDefaultComponentStructure("platform.components.AppController")),m=e.components.add(i,g);c(e,(()=>{const t=e.deprecatedOldBadPerformanceApis.components.getChildren(i);e.platform.controllers.connections.connect(t[0],m,u,{},!0),o(l?B(e,n,0,{pageRef:i},i):i)}))}))}))},open:(e,n,o,i)=>{let{popupRef:r}=i;const p=t().get(r,"id");p&&d(n.appDefinitionId,e,(()=>e.pages.popupPages.open(p)))},close:(e,t)=>{d(t.appDefinitionId,e,(()=>e.pages.popupPages.close()))},isPopupOpened:e=>e.pages.popupPages.isPopupOpened(),getApplicationPopups:function(e,t,n){let{appDefinitionId:o,includeUnmanaged:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=a(t,{appDefinitionId:o},"appDefinitionId",{isRequired:!1});return r?e.pages.popupPages.getDataList().filter((e=>{let{managingAppDefId:t,appDefinitionId:n}=e;return t===r||i&&n===r})):[]},updateBehavior:(e,t,n,o)=>{const i=function(e,t){if(t.name===G)return e.actions.getDefinition("load");throw new Error("Behavior is not supported: ".concat(t.name))}(e,o.behavior),r=function(e,t){if(t.name===G)return{...e.behaviors.getDefinition(G),params:t.params};throw new Error("Behavior is not supported: ".concat(t.name))}(e,o.behavior);e.pages.getPageIdList(!0).map((t=>e.components.get.byId(t))).filter((t=>e.behaviors.get(t).some((e=>{let{behavior:t}=e;return(null==t?void 0:t.targetId)===o.popupRef.id})))).forEach((t=>e.behaviors.update(t,i,o.popupRef,r)))}}},k={create:function(e,t,n,o){let{groupName:i,appDefinitionId:r}=o;const p=a(t,{appDefinitionId:r},"appDefinitionId",{isRequired:!0}),s=d(t.appDefinitionId,e,(()=>e.pagesGroup.create({groupName:i,appDefinitionId:p})));return Promise.resolve(s)},addPageToPagesGroup:function(e,t,n,o){let{pagesGroupPointer:i,pageId:r}=o;d(t.appDefinitionId,e,(()=>e.pagesGroup.addPageToPagesGroup(i,r)))},getById:function(e,t,n,o){let{pagesGroupId:i}=o;return e.pagesGroup.getById(i)},getByGroupName:function(e,t,n,o){let{groupName:i}=o;return e.pagesGroup.getByGroupName(i)},getAll:function(e){return e.pagesGroup.getAll()},remove:function(e,t,n,o){let{pagesGroupPointer:i}=o;d(t.appDefinitionId,e,(()=>e.pagesGroup.remove(i)))}};function U(e,n,o,i){let{routerRef:r}=i;const p=e.routers.get.byRef(r);if(p&&u(n,p.appDefinitionId))return{id:p.id,prefix:p.prefix,config:p.config,pages:t()(p.pages).invertBy().map(((t,n)=>({pageRef:e.pages.getReference(n),pageRoles:t}))).value()}}function V(e,t,n,o){let{prefix:i}=o;const r=e.routers.getRouterRef.byPrefix(i);if(!r)return r;const p=e.routers.get.byRef(r);return p&&u(t,p.appDefinitionId)?r:void 0}const q={add:function(e,t,n){let{prefix:o,config:i,group:r,appDefinitionId:p}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((n=>{const s={appDefinitionId:a(t,{appDefinitionId:p},"appDefinitionId",{isRequired:!0}),prefix:o,config:i};r&&(s.group=r),n(d(t.appDefinitionId,e,(()=>e.routers.add(s))))}))},remove:function(e,t,n,o){let{routerRef:i}=o;const r=e.routers.get.byRef(i);r&&u(t,r.appDefinitionId)&&d(t.appDefinitionId,e,(()=>e.routers.remove(i)))},get:U,getAll:function(e,n,o){let{appDefinitionId:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=a(n,{appDefinitionId:i},"appDefinitionId",{isRequired:!0});return t().map(e.routers.get.byApp(r),(t=>{let{prefix:o}=t;const i=V(e,n,0,{prefix:o});return U(e,n,0,{routerRef:i})}))},update:function(e,t,n,o){let{routerRef:i,prefix:r,config:p}=o;return new Promise(((n,o)=>{const a=e.routers.get.byRef(i);if(a&&u(t,a.appDefinitionId)){const o=((e,t)=>{if(!t)return t;const{replacers:n,rules:o,roleVariations:i,...r}=t;return{...r,..."replacers"in e&&{replacers:e.replacers},..."roleVariations"in e&&{roleVariations:e.roleVariations},..."rules"in e&&{rules:e.rules}}})(a.config,p);d(t.appDefinitionId,e,(()=>e.routers.update(i,{prefix:r,config:o}))),n()}else o()}))},getByPage:function(e,t,n,o){let{pageRef:i}=o;const r=e.routers.getRouterRef.byPage(i);if(!r)return r;const p=e.routers.get.byRef(r);return p&&u(t,p.appDefinitionId)?r:void 0},getByPrefix:V,isValidPrefix:function(e,t,n,o){let{prefix:i,appDefinitionId:r}=o;const p=a(t,{appDefinitionId:r},"appDefinitionId",{isRequired:!0});return e.routers.isValidPrefixByAppDefId(p,i)},getCurrentDynamicRouting:function(e){const t=e.routers.getCurrentInnerRoute();if(t.isDynamic){const n=e.routers.get.byId(t.routerId);return t.prefix=n.prefix,delete t.isDynamic,t}return null},pages:{add:function(e,t,n,o){let{routerRef:i,pageTitle:r,pageRoles:p}=o;return new Promise((n=>{const o=e.routers.get.byRef(i);o&&u(t,o.appDefinitionId)||n(),n(d(t.appDefinitionId,e,(()=>e.routers.pages.add(i,r,p))))}))},delete:function(e,t,n,o){let{routerRef:i,pageRef:r}=o;return new Promise(((n,o)=>{const p=e.routers.get.byRef(i);p&&u(t,p.appDefinitionId)?(d(t.appDefinitionId,e,(()=>e.pages.remove(r.id))),n()):o()}))},connect:function(e,t,n,o){let{routerRef:i,pageRef:r,pageRoles:p,slug:a}=o;const s=e.routers.get.byRef(i);s&&u(t,s.appDefinitionId)&&d(t.appDefinitionId,e,(()=>e.routers.pages.connect(i,r,p,a?{innerRoute:a}:void 0)))},disconnect:function(e,t,n,o){let{routerRef:i,pageRef:r}=o;const p=e.routers.get.byRef(i);p&&u(t,p.appDefinitionId)&&d(t.appDefinitionId,e,(()=>e.routers.pages.disconnect(i,r)))},move:function(e,t,n,o){let{fromRouterRef:i,toRouterRef:r,pageRef:p}=o;const a=e.routers.get.byRef(i),s=e.routers.get.byRef(r);a&&s&&u(t,s.appDefinitionId)&&u(t,a.appDefinitionId)&&d(t.appDefinitionId,e,(()=>e.routers.pages.move(p,i,r)))},listConnectablePages:function(e){return e.routers.pages.listConnectablePages()}}},j={getFooter:function(e){return e.siteSegments.getFooter()},getHeader:function(e){return e.siteSegments.getHeader()},getPagesContainer:function(e){return e.siteSegments.getPagesContainer()},getSiteStructure:function(e){return e.siteSegments.getSiteStructure()}},H=["CHECKBOX","NOTE"],Y={getCustomSignInPageId:function(e){return e.siteMembers.getCustomSignInPageId()},getCustomSignupPageId:function(e){return e.siteMembers.getCustomSignupPageId()},setCustomSignInPageId:function(e,t,n){return e.siteMembers.setCustomSignInPageId(n)},setCustomSignupPageId:function(e,t,n){return e.siteMembers.setCustomSignupPageId(n)},getCustomNoPermissionsPageId:function(e){return e.siteMembers.getCustomNoPermissionsPageId()},setCustomNoPermissionsPageId:function(e,t,n){return e.siteMembers.setCustomNoPermissionsPageId(n)},getPrivacyNoteType:function(e){return e.siteMembers.getPrivacyNoteType()},setPrivacyNoteType:function(e,t){if(H.includes(t))return e.siteMembers.setPrivacyNoteType(t);const n=H.join(", ");throw new Error("Invalid privacy note type. Available options: ".concat(n))}},z={styles:{getAll:function(e){return e.theme.styles.getAll()}},colors:{getAll:function(e){return e.theme.colors.getAll()}},fonts:{getMap:function(e){return e.theme.fonts.getMap()}}},X={TYPE:{SECTION:"tpaSection",WIDGET:"tpaWidget",PLATFORM_ONLY:"platformOnly"}},J={TYPE:{PLATFORM:"PLATFORM",STUDIO:"STUDIO",STUDIO_WIDGET:"STUDIO_WIDGET",PAGE_OUT_OF_IFRAME:"PAGE_OUT_OF_IFRAME",WIDGET_OUT_OF_IFRAME:"WIDGET_OUT_OF_IFRAME",WIDGET:"WIDGET",PAGE:"PAGE"}},K=e=>{var t,n;return(null==e||null===(t=e.appFields)||void 0===t||null===(t=t.appService)||void 0===t?void 0:t.components)||(null==e||null===(n=e.data)||void 0===n?void 0:n.components)||(null==e?void 0:e.components)||[]},Z=function(e){return(e=>{var t,n;const o=K(e);return(null==e||null===(t=e.appFields)||void 0===t||null===(t=t.platform)||void 0===t?void 0:t.platformOnly)||(null===(n=o.find((e=>"PLATFORM"===e.type||"PLATFORM"===e.compType)))||void 0===n||null===(n=n.data)||void 0===n?void 0:n.platformOnly)})(e)?X.TYPE.PLATFORM_ONLY:(e=>Object.values((null==e?void 0:e.widgets)||{}).some((e=>!!e.appPage&&!e.appPage.hidden)))(e)?X.TYPE.SECTION:(e=>K(e).some((e=>e.type===J.TYPE.STUDIO||e.compType===J.TYPE.STUDIO_WIDGET)))(e)?X.TYPE.PLATFORM_ONLY:(e=>Object.values((null==e?void 0:e.widgets)||{}).some((e=>!e.appPage&&!!e.default)))(e)?X.TYPE.WIDGET:(e=>{var t;return Boolean(null==e||null===(t=e.appFields)||void 0===t?void 0:t.platform)||K(e).some((e=>e.type===J.TYPE.PLATFORM||e.compType===J.TYPE.PLATFORM))})(e)?X.TYPE.PLATFORM_ONLY:X.TYPE.WIDGET},Q="_vs_",$="slot",ee="WIDGET",te="PAGE",ne="WIDGET_OUT_OF_IFRAME",oe="PAGE_OUT_OF_IFRAME",ie="STUDIO_WIDGET",re=[ee,te,ne,oe,ie],pe={[ee]:se,[te]:se,[ne]:ce,[oe]:ce,[ie]:async function(e,t,n){let{appDefinitionId:o,widgetId:i}=t;const r=e.components.buildDefaultComponentStructure("wysiwyg.viewer.components.RefComponent");return r.data={...r.data,type:"WidgetRef",appDefinitionId:o,applicationId:n.toString(),widgetId:i},r.layouts={...r.layouts,...de()},r.presets=await async function(e,t){var n;const o=await e.appStudioWidgets.getAppDescriptor(t.appDefinitionId),i=Object.values(o.widgets).find((e=>e.devCenterWidgetId===t.widgetId)),[r]=null!==(n=null==i?void 0:i.presets)&&void 0!==n?n:[];if(!r)return;const p=r.presetId.replace("#","");return{type:"PresetData",layout:p,style:p}}(e,{appDefinitionId:o,widgetId:i}),r}};async function ae(e,t,n){const o=function(e,t){const n=e.tpa.app.getDataByAppDefId(t.appDefinitionId),o=n.components.find((e=>e.componentId===t.widgetId));if(!o)throw new Error('Application "'.concat(n.name,'" is missing the widget component with ID: ').concat(t.widgetId));return o}(e,t),i=function(e){const t=null==e?void 0:e.type;if(!re.includes(t))throw new Error("Widget-plugin type is unsupported -- ".concat(t));return t}(o);return i===ie?pe[i](e,t,n):pe[i](e,t,n,o)}function se(e,t,n,o){var i;let{appDefinitionId:r,widgetId:p}=t;const a=e.components.buildDefaultComponentStructure("wysiwyg.viewer.components.tpapps.TPAWidget");a.data={...a.data,appDefinitionId:r,applicationId:n.toString(),widgetId:p};const s=(null==o||null===(i=o.data)||void 0===i?void 0:i.height)||100;return a.layouts={...a.layouts,...de({height:s})},a}function ce(e,t,n){let{appDefinitionId:o,widgetId:i}=t;const r=e.components.buildDefaultComponentStructure("wysiwyg.viewer.components.tpapps.TPAWidget");return r.data={...r.data,appDefinitionId:o,applicationId:n.toString(),widgetId:i},r.layouts={...r.layouts,...de()},r}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SingleLayoutData",componentLayout:{type:"ComponentLayout",height:e.height?{type:"px",value:e.height}:{type:"auto"},width:{type:"auto"}},itemLayout:{type:"GridItemLayout",gridArea:{rowStart:1,columnStart:1,rowEnd:2,columnEnd:2},alignSelf:"stretch",justifySelf:"stretch"},containerLayout:{type:"GridContainerLayout",rows:[{type:"fr",value:1}],columns:[{type:"fr",value:1}]}}}async function ue(e,t){const n=function(e,t){return e.platform.isAppActive(t.appDefinitionId)||e.tpa.app.isInstalled(t.appDefinitionId)}(e,t);return n||(console.warn("All dependant apps should be installed manually, no dependency driver is used"),await async function(e,t){return new Promise((n=>{t.platform.addApps([e],{[e]:{headlessInstallation:!0},singleAppCallback:()=>{n()}})}))}(t.appDefinitionId,e)),e.tpa.app.getDataByAppDefId(t.appDefinitionId)}const le=e=>{const t=(e=>{function t(t){return e.components.refComponents.isReferredComponent(t)?e.components.refComponents.getRootRefHostCompPointer(t):t}function n(n){const o=t(n.compRef),{widgetId:i,appDefinitionId:r}=e.components.data.get(o);return{appDefinitionId:r,widgetId:i,slotId:n.role}}function o(t){return(o=e.components.slots.getWidgetSlots(t),o.map((e=>{let{compRef:t,role:n,pluginInfo:o}=e;return{role:n,pluginInfo:o,compRef:t}}))).map((e=>({...e,placement:n(e)})));var o}return{getWidgetSlots:o,uninstallWidgetPlugin:function(t){e.components.slots.remove(t,$)},installWidgetPlugin:async function(t,n){const{applicationId:o}=await ue(e,n),i=await ae(e,n,o);return e.components.slots.populate(t,$,i)},getWidgetSlot:function(e){return o(t(e)).find((t=>t.compRef.id===e.id))}}})(e),n=(e=>{function t(t){var n;const o=null===(n=e.tpa.app.getDataByAppDefId(t.appDefinitionId))||void 0===n?void 0:n.components.find((e=>{var n;return(null==e||null===(n=e.data)||void 0===n?void 0:n.referenceComponentId)===t.widgetId}));return null==o?void 0:o.data}function n(e){var n;if(e)return{...null===(n=t({appDefinitionId:e.appDefinitionId,widgetId:e.widgetId}))||void 0===n?void 0:n.marketData,widgetId:e.widgetId,appDefinitionId:e.appDefinitionId}}function o(t,o){const i=o.name,{widgetId:r,appDefinitionId:p}=e.components.data.get(t),a=e.components.data.get(e.components.slots.getSlotsData(t)[i]);return{compRef:(s=t,c=i,{id:"".concat(s.id).concat(Q).concat(c),type:s.type}),role:i,pluginInfo:n(a),placement:{appDefinitionId:p,widgetId:r,slotId:i}};var s,c}function i(e){const[t,n]=e.id.split(Q);return{widgetHostRef:{id:t,type:e.type},slotName:n}}return{getWidgetSlots:function(t){return function(t){var n,o;const{appDefinitionId:i,widgetId:r}=e.components.data.get(t);if(!i)return[];const p=e.platform.getAppManifest(i);if(!p)return[];const a=null!==(n=null===(o=p.controllersStageData)||void 0===o||null===(o=o[r])||void 0===o||null===(o=o.default)||void 0===o?void 0:o.slots)&&void 0!==n?n:{};return Object.entries(a).map((e=>{let[t,n]=e;return{name:t,...n}}))}(t).map((e=>o(t,e)))},getWidgetSlot:function(e){const{widgetHostRef:t,slotName:n}=i(e);return o(t,{displayName:n,name:n})},installWidgetPlugin:async function(t,n){const{applicationId:o}=await ue(e,n),r=await ae(e,n,o),{widgetHostRef:p,slotName:a}=i(t);return e.components.slots.populate(p,a,r)},uninstallWidgetPlugin:function(t){const{widgetHostRef:n,slotName:o}=i(t);e.components.slots.remove(n,o)}}})(e);function o(e){return e.id.includes(Q)?n:t}function i(e){o(e).uninstallWidgetPlugin(e)}return{getWidgetSlots:function(o){return function(o){return function(t){return e.tpa.isTpaByCompType(e.components.getType(t))}(o)?n:t}(o).getWidgetSlots(o)},addWidgetPlugin:async function(e){const t=await(n=e.slotCompRef,o(n).getWidgetSlot(n));var n;return void 0!==(null==t?void 0:t.pluginInfo)&&await i(e.slotCompRef),async function(e,t){return await o(e).installWidgetPlugin(e,t)}(e.slotCompRef,e.widgetPluginPointer)},removeWidgetPlugin:i}},fe=(e,t)=>{const{appDefinitionId:n,applicationId:o}=e.components.data.get(t)||{};return n||o};function ge(e,t,n,o){return e.tpa.appMarket.getDataAsync(o).then((e=>{if(!e||e.error)throw new Error("Application with ".concat(o," appDefinitionId does not exist."));return e}))}function me(e,n,o,i){return new Promise(((o,r)=>{const p=t().clone(i);t().get(i,"appDefinitionId")?i.appDefinitionId!==e.platform.editorApps.WIX_CODE.appDefId?ge(e,0,0,i.appDefinitionId).then((a=>{if("Wix"===a.by){if(p.callback=function(p){if(p.onError)r(new Error(p.onError));else if(n=e.tpa.app.getDataByAppDefId(i.appDefinitionId),p.page){const i=e.pages.data.get(p.page.id);o({instanceId:t().get(n,"instanceId"),pageRef:p.page,pageUriSEO:t().get(i,"pageUriSEO"),title:t().get(i,"title")})}else o({instanceId:t().get(n,"instanceId")})},e.tpa.app.isInstalled(i.appDefinitionId)&&!function(e){var t;return Z(e)===X.TYPE.WIDGET&&(null==e||null===(t=e.widgets)||void 0===t?void 0:t.every((e=>!e.addOnlyOnce)))}(a))return void r(new Error("Application already installed."));d(n.appDefinitionId,e,(()=>{const s=function(e){var t;return 1===(null===(t=e.componentTypes)||void 0===t?void 0:t.length)&&e.componentTypes.includes(J.TYPE.PLATFORM)}(i)&&e.tpa.app.hasEditorPlatformPart(a);if(Z(a)===X.TYPE.PLATFORM_ONLY||s){const p={appDefinitionId:t().get(n,"appDefinitionId")},a=i.originInfo?t().assign({},i.originInfo,p):p,s={origin:{initiator:"APP",type:i.editorType,info:a}};return i.sourceTemplateId&&(s.sourceTemplateId=i.sourceTemplateId),i.isSilent&&(s.isSilent=!0),e.platform.provision(i.appDefinitionId,s).then(o,r)}return e.tpa.app.add(i.appDefinitionId,p)}))}else r(new Error("Can't add a non Wix application"))})).catch(r):e.wixCode.provision({onSuccess:o,onError:r}):r(new Error("options must contain appDefinitionId"))}))}const Ie=(e,t)=>n=>{n.error?t(new Error(n.error.message)):e(n)},De={isAppSectionInstalled:function(e,n,o){let{sectionId:i,appDefinitionId:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise(((o,a)=>{if(!i)return void a(new Error("options must contain sectionId"));let s=n.appDefinitionId;if(!p(n)||r){if(r){const n=e.tpa.app.getDataByAppDefId(r);s=t().get(n,"appDefinitionId")}o(e.tpaV2.section.isSectionInstalledByTpaPageId(s,i))}else a(new Error("options must contain appDefinitionId"))}))},isApplicationInstalled:function(e,t,n){let{appDefinitionId:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise(((t,n)=>{o?t(e.tpa.app.isInstalled(o)):n(new Error("options must contain appDefinitionId"))}))},setStyleParams:function(e,n,o,i){return new Promise(((o,r)=>{if(!i||!i.compRef)return void r("options must include compRef property");if(!i||!i.styleParams||!t().isArray(i.styleParams))return void r("options must include styleParams property and styleParams must be an array");const p=fe(e,i.compRef);p?u(n,p)?d(n.appDefinitionId,e,(()=>e.tpa.style.setCompStyleParam(i.compRef,i.styleParams,(()=>o())))):r("It is not allowed to set style params for other applications, application ".concat(n.appDefinitionId," cannot set applications ").concat(p," components style params")):r("could not find component data for the given component ref")}))},getStyleParams:function(e,t,n,o){return new Promise(((n,i)=>{if(!o||!o.compRef)return void i("options must include compRef property");const r=fe(e,o.compRef);if(!r)return void i("could not find component data for the given component ref");if(!u(t,r))return void i("It is not allowed to get the style params from other applications, application ".concat(t.appDefinitionId," cannot get applications ").concat(r," components style params"));const{style:p}=e.tpa.style.getByComp(o.compRef)||{};n(p)}))},getSiteTextPresets:function(e,t,n,o){if(!o||!o.compRef)throw new Error("options must include compRef property");const{siteTextPresets:i}=e.tpa.style.get(o.compRef.id);return i},getSiteColors:function(e,t,n,o){if(!o||!o.compRef)throw new Error("options must include compRef property");const{siteColors:i}=e.tpa.style.get(o.compRef.id);return i},getPageRefByTPAPageId:function(e,t,n,o){const i=e.pages.getPagesData().find((e=>(null==e?void 0:e.tpaPageId)===o.tpaPageId));if(i)return e.pages.getReference(i.id)},data:{setAppPublicData:function(e,n,o,i){return new Promise(((o,r)=>{d(n.appDefinitionId,e,(()=>{i&&i.key&&!t().isUndefined(i.value)?e.tpaV2.data.set(n.appDefinitionId,i.key,i.value,Ie(o,r)):r(new Error("options must include: key, value"))}))}))},getAppPublicData:function(e,t,n,o){return new Promise(((n,i)=>{d(t.appDefinitionId,e,(()=>{o&&o.key?e.tpaV2.data.app.get(t.appDefinitionId,o.key,Ie(n,i)):i(new Error("options must include: key"))}))}))},getAll:function(e,t,n,o){return new Promise(((t,n)=>{if(!o||!o.compRef)return void n(new Error("options must include compRef property"));const i=fe(e,o.compRef);void 0!==i?e.tpaV2.data.getPublicData(i,o.compRef,Ie(t,n)):n(new Error("could not find component data for the given component ref"))}))},set:function(e,t,n,o){return new Promise(((n,i)=>{if(!o||!o.compRef)return void i(new Error("options must include compRef property"));if(!o.key)return void i(new Error("options must include key property"));const r=fe(e,o.compRef);r?u(t,r)?d(t.appDefinitionId,e,(()=>e.tpa.data.set(o.compRef,o.key,o.value,o.scope||"COMPONENT",Ie(n,i)))):i(new Error("it is not allowed to set the public data from other applications, application ".concat(t.appDefinitionId," cannot set applications ").concat(r," public data"))):i(new Error("could not find component data for the given component ref"))}))},remove:function(e,t,n,o){return new Promise(((n,i)=>{if(!o||!o.compRef)return void i(new Error("options must include compRef property"));if(!o.key)return void i(new Error("options must include key property"));const r=fe(e,o.compRef);r?u(t,r)?d(t.appDefinitionId,e,(()=>e.tpa.data.remove(o.compRef,o.key,o.scope||"COMPONENT",Ie(n,i)))):i(new Error("it is not allowed to remove the public data from other applications, application ".concat(t.appDefinitionId," cannot remove applications ").concat(r," public data"))):i(new Error("could not find component data for the given component ref"))}))}},add:{application:me,component:function(e,n,o,i){return new Promise(((o,r)=>{const a=t().clone(i);if(t().get(i,"componentType")){if(!i.appDefinitionId){if(p(n))return void r(new Error("options must contain appDefinitionId"));a.appDefinitionId=n.appDefinitionId}if("WIDGET"===i.componentType){if(!t().isObject(i.widget))return void r(new Error("options must contain a widget object"));a.widget.tpaWidgetId=i.widget.widgetId}else if("PAGE"===i.componentType){if(!t().isObject(i.page))return void r(new Error("options must contain a page object"));if(i.page.isHidden&&!t().isBoolean(i.page.isHidden))return void r(new Error("isHidden param should be of type boolean"))}a.callback=function(n){if(n.onError)r(new Error(n.onError));else if("WIDGET"===i.componentType)o({compId:n.comp.id});else{const i=e.pages.data.get(n.page.id);o({compId:n.sectionId,pageRef:n.page,pageUriSEO:t().get(i,"pageUriSEO"),title:t().get(i,"title")})}},d(n.appDefinitionId,e,(()=>e.tpa.comp.add(a)))}else r(new Error("options must contain componentType"))}))}},app:{getDataByAppDefId:function(e,t,n,o){return e.tpa.app.getDataByAppDefId(o)},getAppMarketDataByAppDefId:ge,getAppDataByAppDefId:function(e,t,n,o){return e.platform.getAppDataByAppDefId(o)},getAllCompsByApplicationId:function(e,t,n,o){return e.tpa.app.getAllCompsByApplicationId(o)},getAllComps:function(e,t,n,o){return e.tpaV2.app.getAllComps(o)},refreshApp:function(e,t){let{appDefinitionId:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=a(t,{appDefinitionId:n},"appDefinitionId",{isRequired:!0}),i=e.tpaV2.app.getAllComps([o]);return d(t.appDefinitionId,e,(()=>e.tpa.app.refreshApp(i)))},delete:function(e,t){let{appDefinitionId:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=a(t,{appDefinitionId:n},"appDefinitionId",{isRequired:!0});return new Promise((n=>{d(t.appDefinitionId,e,(()=>e.platform.uninstall(o))),e.waitForChangesApplied(n)}))},add:me},widgetPlugins:{getWidgetSlots:function(e,t,n,o){return le(e).getWidgetSlots(o.widgetRef)},addWidgetPlugin:function(e,t,n,o){return le(e).addWidgetPlugin(o)},removeWidgetPlugin:function(e,t,n,o){return le(e).removeWidgetPlugin(o.slotCompRef)}}};function ye(e){return{name:e.name,fullPath:e.location,isDirectory:e.directory}}const ve={listChildren:function(e,n,o,i){const r=e.wixCode.fileSystem,p=r.getVirtualDescriptor(i.path,!0);return r.getChildren(p).then((e=>t().map(e,ye)))},readFile:function(e,t,n,o){const i=e.wixCode.fileSystem,r=i.getVirtualDescriptor(o.path,!1);return i.readFile(r)},writeFile:function(e,t,n,o){const i=e.wixCode.fileSystem,r=i.getVirtualDescriptor(o.path,!1);return d(t.appDefinitionId,e,(()=>i.writeFile(r,o.content)))},deleteFile:function(e,t,n,o){const i=e.wixCode.fileSystem,r=i.getVirtualDescriptor(o.path,!1);return d(t.appDefinitionId,e,(()=>i.deleteItem(r)))},flush:function(e,t){return d(t.appDefinitionId,e,(()=>e.wixCode.fileSystem.flush()))},getViewerInfo:function(e){return e.wixCode.fileSystem.getViewerInfo()}},Re={hiddenComponents:{show:function(e,t,n,o){let{componentRef:i}=o;const r=e.pages.getFocusedPageId();d(t.appDefinitionId,e,(()=>e.mobile.hiddenComponents.show(i.id,r)))}}},Pe={get:function(e,t,n,o){let{componentRef:i}=o;return e.responsiveLayout.get(i)},update:function(e,t,n,o){let{componentRef:i,responsiveLayout:r}=o;d(t.appDefinitionId,e,(()=>e.responsiveLayout.update(i,r)))}},he={getSkipToContent:function(e){return e.accessibility.skipToContent.get()},setSkipToContent:function(e,t,n,o){return d(t.appDefinitionId,e,(()=>e.accessibility.skipToContent.set(o)))},getVisualFocus:function(e){return e.accessibility.visualFocus.get()},setVisualFocus:function(e,t,n,o){return d(t.appDefinitionId,e,(()=>e.accessibility.visualFocus.set(o)))},getAutoDomReorder:function(e){return e.accessibility.autoDomReorder.get()},setAutoDomReorder:function(e,t,n,o){return d(t.appDefinitionId,e,(()=>e.accessibility.autoDomReorder.set(o)))}},we={isCoBranded:function(e){return e.account.isCoBranded()}},Ce={registerToErrorThrownForContext:function(e,t){const o=n+t.appDefinitionId;e.platform.requestAPIFromWorker(o).then((n=>{let{callback:o}=n;return e.registerToErrorThrownForContext(t.appDefinitionId,o)}))},unRegisterToErrorThrownForContext:function(e,t){const o=n+t.appDefinitionId;e.platform.requestAPIFromWorker(o).then((n=>{let{callback:o}=n;return e.unRegisterToErrorThrownForContext(t.appDefinitionId,o)}))}},Te={migrate:{convertAppPage:function(e,t,n,o){let{pageRef:i}=o;return e.wixapps.migrate.convertAppPage(i)}}},Ae={screen:{getScreenResolution:function(e){return e.env.screen.getResolution()}}},Ee={runAndWaitForApproval:async function(e,t,n,o){return await e.transactions.runAndWaitForApproval(o,{appDefinitionId:t.appDefinitionId})}},be={isGroupsPermissionsGranted:function(){return!0},isCustomPermissionsGranted:function(){return!0}}})(),i})()));
//esm-shim-webpack-plugin-exports

//# sourceMappingURL=platform-api.min.js.map